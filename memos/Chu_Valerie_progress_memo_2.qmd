---
title: "Progress Memo 2"
subtitle: |
  | Final Project 
  | Data Science 2 with R (STAT 301-2)
author: "Valerie Chu"
date: today

format:
  html:
    toc: true
    embed-resources: true
    
execute:
  warning: false

from: markdown+emoji 
reference-location: margin
citation-location: margin
---

::: {.callout-tip icon=false}

## Github Repo Link

[https://github.com/stat301-2-2024-winter/final-project-2-valerieyichu.git](https://github.com/stat301-2-2024-winter/final-project-2-valerieyichu.git)

:::


```{r}
#| echo: false

# load packages
library(tidyverse)
library(tidymodels)
library(here)

# handle common conflicts
tidymodels_prefer()

```


```{r, echo = FALSE}
# Read in the avocado dataset
avocado <- read_csv(here("data/avocado.csv")) |> 
  janitor::clean_names()

```

## A Quick Overview

I'm Californian, and avocados are a big thing. There's avocado toast, avocado spread, avocado in salad, and much more. That's why I was interested in a dataset about avocados. Hopefully, this final project will help me pinpoint and eventually move to a city with the cheapest avocados...

This dataset contains historical data on avocado prices and sales volume in multiple US markets.

This is the link to the Avocado Prices dataset on Kaggle:
**[https://www.kaggle.com/datasets/neuromusic/avocado-prices](https://www.kaggle.com/datasets/neuromusic/avocado-prices)** ^[Kiggins, Justin. "Avocado Prices." Kaggle, 2018, https://www.kaggle.com/datasets/neuromusic/avocado-prices.]

This data was downloaded from the Hass Avocado Board website ^[Hass Avocado Board, https://hassavocadoboard.com/] in May of 2018 and compiled into a single CSV. There are 18,249 observations in this dataset and 14 variables. There is 1 date-time object, 10 numerical variables, 2 categorical variables and 1 id column. There is no missingness in this dataset. 

**I want to predict the prices avocados will sell at (ie. `average_price`).** So this is a **regression problem**. 

These are the definitions for some of the variables: 

- `date` - The date of the observation

- `average_price` - the average price of a single avocado

- `type` - conventional or organic

- `year` - the year

- `region` - the city or region of the observation

- `total_volume` - Total number of avocados sold

- `x4046` - Total number of avocados with PLU 4046 sold

- `x4225` - Total number of avocados with PLU 4225 sold

- `x4770` - Total number of avocados with PLU 4770 sold



## The Assessment Metric

**The assessment metric is the RMSE.** 


## My Analysis Plan

I split the data using a 70-30 split, which results in 12,772 observations in the training dataset and 5,477 observations in the testing dataset. 

I also v-fold cross-validation to resample my training data. I used 10 folds and 5 repeats. 

I used these models: Null (baseline model), OLS, Lasso, Ridge, Boosted Tree, K Nearest Neighbors, and Random Forest. 

I will be using a kitchen sink recipe and a recipe with interactions, the latter of which I will create. 


## A Table

The table of RMSEs and standard errors created below was made using kitchen recipes. It displays the RMSE and standard error for the model with the lowest RMSE for each model type.

The baseline is the null model. I've also defined and fitted the OLS, Lasso, Ridge, Boosted Tree, K Nearest Neighbors, and Random Forest models. 

```{r, echo = FALSE}
load(here("results/tbl_result.rda"))
tbl_result |> 
  knitr::kable()

```

The best model is the random forest model because it has the lowest RMSE. It also has a low standard error. So the predictions created by the random forest model should be the closest to the true values.

## EDA

Next, I will do a preliminary EDA to continue on the progress made in Progress Memo 1. This will help decide what interactions to use in my second recipe. 

Below is a correlation plot.

```{r, echo = FALSE}
avocado |> 
  select(average_price, total_volume, x4046, x4225, x4770, total_bags, 
         small_bags, large_bags, x_large_bags) |> 
  cor() |> 
  knitr::kable()
```
It seems like for my second recipe, I could create interactions between `total_bags` and `small_bags`, `total_volume` and `x4046`, and `total_volume` and `x4225`. (As a reminder, 4046 and 4225 are PLU numbers â€” numbers used to properly identify avocados sold at retail.)


## How it's going

I've split and folded the data; created a kitchen sink recipe; and fitted null, OLS, lasso, ridge, boosted tree, k nearest neighbors, and random forest models; and found the RMSE and standard error for the model with the lowest RMSE for each model type. Right now, I don't have any potential issues or concerns. 

Moving forward, I plan to conduct a more comprehensive EDA than the one I did for Progress Memo 1 so that I can determine what interaction terms I should use for my second recipe, and I will tune and fit my other models accordingly so that I can determine the best model overall. 


